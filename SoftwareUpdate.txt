Python refactorings and simplifications (#7549)